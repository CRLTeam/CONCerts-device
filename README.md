## ConCERTS: An IoT Device activity simulator for building an IoT Cybersecurity Research Range

## Description

The repository holds the software required for simulating an IoT device. Each device has:

- Settings for devices
- Commands
- Log file of executed commands
- Activity simulation script

This version of the device simulator supports ten types of devices:

1. Card Reader - a device that can simulate the swiping of a security card
2. Card Manager - a controller that compares the value of the card read with a whitelist of cards
3. Door Lock - a door lock that can lock and unlock a door

![Card Reader Pattern](https://github.com/CRLTeam/CONCerts-device/blob/main/documentation/CardReaderPattern.png?raw=true)

To simulate all three working together, you need to provide the settings for the card reader and door manager and then set the script for the card reader.  Running the card reader script will cascade the simulation to all of the devices.  See: start.sh script for automation of the simulation.

4. Motion Detector - a device that detects motion by measuring changes in distance using ultrasonic waves
5. Motion Manager - a controller that turns on the light if motion is detected and turns off the light if no motion is detected for a time period
6. Light - a light that can turn on and off

![Motion Diagram](https://github.com/arsh-aps/ConCERTS-device/assets/114761529/1bde315e-1fd5-4b5a-bebd-7792ff46727a)

Similar to card reader, provide settings for motion detector and motion manager and set script for motion detector to simulate all three working together. Additionally, you can convert the logfile generated by using the detector to create a script.

7. Thermostat - a device that can measure the temperature in a room
8. HVAC Controller - a device that controls airconditioner and furnace 
9. Airconditioner - a device that can cool the air in a room to a set temperature
10. Furnace - a device that can heat the air in a room to a set temperature

## Running the app

```bash
# build docker image
docker build -t concerts .

# run docker container
docker run --privileged -p 3000:3000 concerts
```

## Swagger Interface

This software supports a swagger interface to view the REST API.

http://localhost:3000/api

## Device REST Calls

| Call                            | Description                                                  | Parameters                                                   |
| ------------------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| POST /**card-reader**/settings  | Set the address of the card manager                          | { "controllerUrl": "http://localhost:3000/card-manager/command" } |
| POST /**card-reader**/command   | Run a card swipe                                             | { "action": "swipe","card": 1234 }          |
| POST /**card-reader**/script    | Set the script for simulation                                | { "script": { "action": "swipe", "card": 123, "delay": 5}, { "action": "swipe", "card": 321, "delay": 10 }], "repeat": } |
| GET /**card-reader**/start      | Start the simulation script                                  |                                                              |
| GET /**card-reader**/log        | Get the log file of activity                                 |                                                              |
| POST /**card-manager**/settings | Set the whitelist of card number and the address of the door lock | { "valid": [ 1234, 1235, 1236  ], "lockURL": "http://localhost:3000/door-lock/command" } |
| POST /**card-manager**/command  | Check a card number                                          | { "action": "check", "cardId": 1234 }        |
| POST /**card-manager**/script   | Set the script for simulation                                | { "script": [{ "action": "check", "cardId": 1234, "delay": 10 }, { "action": "check", "cardId": 4321,  "delay": 20 }], "repeat": 2} |
| GET /**door-lock**/start        | Start the simulation script                                  |                                                              |
| GET /**door-lock**/log          | Get the log file of activity                                 |                                                              |
| POST /**door-lock**/settings    | Turn on or off door lock buzzer sound                        | { "buzz": "true" }                                 |
| POST /**door-lock**/command     | Open the lock                                                | { "action": "open", "wait": 5 }              |
| POST /**door-lock**/script      | Set the script for simulation                                | { "script": [{ "action": "open", "wait": 5, "delay": 10 }, { "action": "open", "wait": 5, "delay": 20 }], "repeat": 2 } |
| GET /**door-lock**/start        | Start the simulation script                                  |                                                              |
| GET /**door-lock**/log          | Get the log file of activity                                 |                                                              |



## Project Maintainer


## License

CONCerts is [MIT licensed](LICENSE).
